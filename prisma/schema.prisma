// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlite"
  url      = env("DATABASE_URL")
}

/// 댓글 테이블 - 사용자들이 작성한 댓글을 저장
/// 간단한 게시판 형태의 댓글 시스템
model Comment {
  /// 댓글 고유 ID (자동 증가)
  id      Int    @id @default(autoincrement())
  /// 댓글 작성자 이름
  author  String
  /// 댓글 내용
  content String

  @@map("comments")
}

/// 사용자 테이블 - Google OAuth로 로그인한 사용자 정보 저장
/// Google 계정과 연동된 사용자 관리 시스템
model User {
  /// 사용자 고유 ID (자동 증가)
  id        Int      @id @default(autoincrement())
  /// Google 계정 고유 ID (Google에서 제공)
  googleId  String   @unique @map("google_id")
  /// 사용자 이메일 주소 (Google 계정 이메일)
  email     String   @unique
  /// 사용자 이름 (Google 계정 이름)
  name      String
  /// 사용자 프로필 사진 URL (Google 계정 프로필 사진, 선택사항)
  picture   String?
  /// 계정 생성 시간
  createdAt DateTime @default(now()) @map("created_at")
  /// 계정 정보 마지막 업데이트 시간
  updatedAt DateTime @updatedAt @map("updated_at")

  /// 관계: 한 사용자는 여러 세션을 가질 수 있음
  sessions Session[]

  @@map("users")
}

/// 세션 테이블 - JWT 토큰 기반 사용자 세션 관리
/// 사용자 로그인 상태와 토큰 유효성을 관리
model Session {
  /// 세션 고유 ID (자동 증가)
  id        Int      @id @default(autoincrement())
  /// 세션 소유자의 사용자 ID
  userId    Int      @map("user_id")
  /// JWT 토큰 문자열 (고유해야 함)
  jwtToken  String   @unique @map("jwt_token")
  /// 토큰 만료 시간
  expiresAt DateTime @map("expires_at")
  /// 세션 생성 시간
  createdAt DateTime @default(now()) @map("created_at")

  /// 관계: 세션은 하나의 사용자에 속함 (사용자 삭제 시 세션도 삭제)
  user User @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@map("sessions")
}

/// JSON 저장 테이블 - 사용자별 임의의 JSON 데이터 저장
/// 유연한 데이터 저장을 위한 NoSQL 스타일 저장소
model JsonStorage {
  /// JSON 데이터 고유 ID (자동 증가)
  id        Int      @id @default(autoincrement())
  /// 데이터 소유자 ID (문자열 타입으로 저장)
  userId    String   @map("user_id")
  /// JSON 데이터 (문자열로 직렬화되어 저장)
  jsonData  String   @map("json_data")
  /// 데이터 생성 시간
  createdAt DateTime @default(now()) @map("created_at")
  /// 데이터 마지막 업데이트 시간
  updatedAt DateTime @updatedAt @map("updated_at")

  @@map("json_storage")
} 